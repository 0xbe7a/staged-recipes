context:
  name: renode-cores
  version: "1.15.3"
  python_min: "3.6"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  - url: https://github.com/renode/renode/releases/download/v${{ version }}/renode_${{ version }}_source.tar.xz
    sha256: 40c50afe8db86a9c63f4a86b93116a6babd43bf241cfaac47b2c0d2cbc2b15a8
  #- url: https://github.com/renode/renode/archive/refs/tags/v${{ version }}.tar.gz
  #  sha256: 692604eba16476596ddbc91a4cba1bd5da681dbda076d1980b81f1d333edb7c0
    patches:
      - if: unix
        then:
          - patches/update-for-cmake-build.sh.patch

build:
  number: 0

requirements:
  build:
    - ${{ compiler('c') }}
    - ${{ compiler('cxx') }}
    - ${{ stdlib('c') }}
    - cmake
    - make
    - tar
    - if: unix
      then:
        - sed
      else:
        - m2-sed

tests:
  - package_contents:
      files:
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-xtensa-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-arm-be.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-arm-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-arm-m-be.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-arm-m-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-arm64-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-i386-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-ppc-be.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-ppc-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-ppc64-be.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-ppc64-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-riscv-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-riscv64-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-sparc-be.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-sparc-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-x86_64-le.so
        - ${{ "LIBRARY/" if not unix }}lib/renode-cores/translate-xtensa-le.so

about:
  homepage: https://github.com/renode/renode
  summary: "Antmicro's open source simulation and virtual development framework for complex embedded systems"
  description: |
    Renode was created by Antmicro as a virtual development tool for multi-node
    embedded networks (both wired and wireless) and is intended to enable a scalable
    workflow for creating effective, tested and secure IoT systems.

    With Renode, developing, testing, debugging and simulating unmodified software
    for IoT devices is fast, cost-effective and reliable.
  license: MIT
  license_file:
    - LICENSE
    - licensefiles/
  documentation: https://renode.io/
  repository: https://github.com/renode/renode

extra:
  recipe-maintainers:
    - MementoRC
    - danielnachun
