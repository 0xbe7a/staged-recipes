# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
schema_version: 1

context:
  name: hcl2json
  version: "0.6.7"

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://github.com/tmccombs/hcl2json/archive/v${{ version }}.tar.gz
  sha256: 868a6986ae983b703c9845f315b27ab19207b816a8f16f6d44041e4d78764f70


build:
  number: 0
  skip:
    - not linux-64
  script: |
    set -exuo pipefail
    go build -trimpath -o "${{ PREFIX }}/bin/hcl2json"
    go-licenses save . --save_path ./thirdparty --ignore github.com/tmccombs/hcl2json
    # Clear out cache to avoid file not removable warnings
    chmod -R u+w $(go env GOPATH) && rm -r $(go env GOPATH)

requirements:
  build:
    - ${{ compiler('go-nocgo') }}
    - go-licenses


tests:
  - script:
    - hcl2json --version

about:
  homepage: https://github.com/tmccombs/hcl2json
  summary: 'Convert hcl2 to json'
  license: Apache-2.0
  license_file:
    - LICENSE
    - thirdparty/
  repository: https://github.com/tmccombs/hcl2json

extra:
  recipe-maintainers:
    - dhirschfeld
