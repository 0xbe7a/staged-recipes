context:
  version: "1.46.0"

package:
  name: process-compose
  version: ${{ version }}

source:
  url: https://github.com/F1bonacc1/process-compose/archive/refs/tags/v${{ version }}.tar.gz
  sha256: 709399d33dbc1d9ec3bf3bbf4533bf5a2351e57ece76a2f645fa8463859bb80c
  target_directory: src

build:
  number: 0
  script:
    - cd src
    - go-licenses save ./src --save_path ../library_licenses
    - if: win
      then: go build -v -o %LIBRARY_BIN%\process-compose.exe ./src
      else: go build -v -o $PREFIX/bin/process-compose ./src
    - if: unix
      then:
        - mkdir -p $PREFIX/share/bash-completion/completions
        - process-compose completion bash > $PREFIX/share/bash-completion/completions/process-compose
        - mkdir -p $PREFIX/share/zsh/site-functions
        - process-compose completion zsh > $PREFIX/share/zsh/site-functions/_process-compose
        - mkdir -p $PREFIX/share/fish/vendor_completions.d
        - process-compose completion fish > $PREFIX/share/fish/vendor_completions.d/process-compose.fish

requirements:
  build:
    - ${{ stdlib("c") }}
    - ${{ compiler('go-nocgo') }}
    - go-licenses

tests:
  - script:
      - process-compose version
      - process-compose --help

about:
  homepage: https://temporal.io/
  license: MIT
  license_file:
    - LICENSE
    - library_licenses/
  summary: Command-line interface for running and interacting with Temporal Server and UI
  description: |
    Temporal CLI is a command-line interface for running and interacting with Temporal Server and UI.
  repository: https://github.com/temporalio/cli
  documentation: https://docs.temporal.io/cli

extra:
  recipe-maintainers:
    - wolfv
