{% set name = "openfoam" %}
{% set version = "v2412" %}
{% set build = 0 %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://develop.openfoam.com/Development/openfoam/-/archive/OpenFOAM-{{ version }}/openfoam-OpenFOAM-{{ version }}.tar.gz
  sha256: 27d06edb4a6ffc6f88a494edd3b289d5d0a0874866a416b6b0d0a26aba2d9c4a

build:
  skip: True  # [not linux]
  number: {{ build }}
  rpaths:
    - lib/
    - lib/sys-openmpi/
    - lib/dummy/

requirements:
  build:
    - gcc
    - gxx
    #- openmpi
    - make  # [not win]
    - ninja  # [win]
    - flex
    - ncurses
    - parmetis
    - scotch
    - ptscotch
    - kahip
    - petsc
    - hypre
    - zlib
  host:
    - gcc
    - gxx
    #- openmpi
    - make  # [not win]
    - ninja  # [win]
    - flex
    - ncurses
    - parmetis
    - scotch
    - ptscotch
    - kahip
    - petsc
    - hypre
    - zlib
  run:
    #- openmpi
    - flex
    - ncurses
    - parmetis
    - scotch
    - ptscotch
    - kahip
    - petsc
    - hypre
    - zlib

test:
  commands:
    - test -f ${PREFIX}/bin/blockMesh  # [linux]
    - ${PREFIX}/bin/foamTestTutorial -full incompressible/simpleFoam/pitzDaily

about:
  home: https://openfoam.com/
  summary: OpenFOAM-{{ version }}
  description: |
    OpenFOAM is a free, open source computational fluid dynamics (CFD) 
    software package released by the ESI.
  license: GPL-3.0-only
  license_family: GPL
  license_file: COPYING
  doc_url: https://www.openfoam.com/documentation/overview
  dev_url: https://www.openfoam.com/download/openfoam-repositories

extra:
  recipe-maintainers:
    - ldallolio
    - daviddanan
