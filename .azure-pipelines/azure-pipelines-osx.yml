# This file was generated automatically from conda-smithy. To update this configuration,
# update the conda-forge.yml and/or the recipe/meta.yaml.
# -*- mode: yaml -*-

jobs:
  # - job: mac_15
  #   pool:
  #     vmImage: macos-15
  #   steps:
  #     - script: ./.scripts/debug_osx_arch.sh
  #       displayName: Get architecture
  # - job: mac_latest
  #   pool:
  #     vmImage: macos-latest
  #   steps:
  #     - script: ./.scripts/debug_osx_arch.sh
  #       displayName: Get architecture
  # - job: mac_14
  #   pool:
  #     vmImage: macos-14
  #   steps:
  #     - script: ./.scripts/debug_osx_arch.sh
  #       displayName: Get architecture
  # - job: mac_13
  #   pool:
  #     vmImage: macos-13
  #   steps:
  #     - script: ./.scripts/debug_osx_arch.sh
  #       displayName: Get architecture
- job: osx
  condition: not(eq(variables['Build.SourceBranch'], 'refs/heads/main'))
  pool:
    vmImage: macOS-13
  strategy:
    matrix:
      osx_arm64:
        CONFIG: osx_arm64
    maxParallel: 8
  timeoutInMinutes: 360

  steps:
  - script: |
      ./.scripts/new_run_osx_build.sh
    displayName: Run OSX build
    env:
      CI: azure
      CONDA_BLD_PATH: /Users/runner/bld
  - publish: /Users/runner/bld/osx-arm64/
    artifact: conda_pkgs_osx
